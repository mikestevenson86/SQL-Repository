SELECT 
DATEPART(Year, CreatedDate) YearBooked,
case when CONVERT(time, CreatedDate) between '00:00' and '01:00' then '12am-1am'
when CONVERT(time, CreatedDate) between '01:00' and '02:00' then '1am-2am'
when CONVERT(time, CreatedDate) between '02:00' and '03:00' then '2am-3am'
when CONVERT(time, CreatedDate) between '03:00' and '04:00' then '3am-4am'
when CONVERT(time, CreatedDate) between '04:00' and '05:00' then '4am-5am'
when CONVERT(time, CreatedDate) between '05:00' and '06:00' then '5am-6am'
when CONVERT(time, CreatedDate) between '06:00' and '07:00' then '6am-7am'
when CONVERT(time, CreatedDate) between '07:00' and '08:00' then '7am-8am'
when CONVERT(time, CreatedDate) between '08:00' and '09:00' then '8am-9am'
when CONVERT(time, CreatedDate) between '09:00' and '10:00' then '9am-10am'
when CONVERT(time, CreatedDate) between '10:00' and '11:00' then '10am-11am'
when CONVERT(time, CreatedDate) between '11:00' and '12:00' then '11am-12pm'
when CONVERT(time, CreatedDate) between '12:00' and '13:00' then '12pm-1pm'
when CONVERT(time, CreatedDate) between '13:00' and '14:00' then '1pm-2pm'
when CONVERT(time, CreatedDate) between '14:00' and '15:00' then '2pm-3pm'
when CONVERT(time, CreatedDate) between '15:00' and '16:00' then '3pm-4pm'
when CONVERT(time, CreatedDate) between '16:00' and '17:00' then '4pm-5pm'
when CONVERT(time, CreatedDate) between '17:00' and '18:00' then '5pm-6pm'
when CONVERT(time, CreatedDate) between '18:00' and '19:00' then '6pm-7pm'
when CONVERT(time, CreatedDate) between '19:00' and '20:00' then '7pm-8pm'
when CONVERT(time, CreatedDate) between '20:00' and '21:00' then '8pm-9pm'
when CONVERT(time, CreatedDate) between '21:00' and '22:00' then '9pm-10pm'
when CONVERT(time, CreatedDate) between '22:00' and '23:00' then '10pm-11pm'
when CONVERT(time, CreatedDate) between '23:00' and '23:59' then '11pm-12am'
else '' end TimeBracket,
COUNT(Id)
FROM Salesforce..LeadHistory
WHERE Field = 'Status' and NewValue = 'Data Quality'
GROUP BY 
DATEPART(Year, CreatedDate),
case when CONVERT(time, CreatedDate) between '00:00' and '01:00' then '12am-1am'
when CONVERT(time, CreatedDate) between '01:00' and '02:00' then '1am-2am'
when CONVERT(time, CreatedDate) between '02:00' and '03:00' then '2am-3am'
when CONVERT(time, CreatedDate) between '03:00' and '04:00' then '3am-4am'
when CONVERT(time, CreatedDate) between '04:00' and '05:00' then '4am-5am'
when CONVERT(time, CreatedDate) between '05:00' and '06:00' then '5am-6am'
when CONVERT(time, CreatedDate) between '06:00' and '07:00' then '6am-7am'
when CONVERT(time, CreatedDate) between '07:00' and '08:00' then '7am-8am'
when CONVERT(time, CreatedDate) between '08:00' and '09:00' then '8am-9am'
when CONVERT(time, CreatedDate) between '09:00' and '10:00' then '9am-10am'
when CONVERT(time, CreatedDate) between '10:00' and '11:00' then '10am-11am'
when CONVERT(time, CreatedDate) between '11:00' and '12:00' then '11am-12pm'
when CONVERT(time, CreatedDate) between '12:00' and '13:00' then '12pm-1pm'
when CONVERT(time, CreatedDate) between '13:00' and '14:00' then '1pm-2pm'
when CONVERT(time, CreatedDate) between '14:00' and '15:00' then '2pm-3pm'
when CONVERT(time, CreatedDate) between '15:00' and '16:00' then '3pm-4pm'
when CONVERT(time, CreatedDate) between '16:00' and '17:00' then '4pm-5pm'
when CONVERT(time, CreatedDate) between '17:00' and '18:00' then '5pm-6pm'
when CONVERT(time, CreatedDate) between '18:00' and '19:00' then '6pm-7pm'
when CONVERT(time, CreatedDate) between '19:00' and '20:00' then '7pm-8pm'
when CONVERT(time, CreatedDate) between '20:00' and '21:00' then '8pm-9pm'
when CONVERT(time, CreatedDate) between '21:00' and '22:00' then '9pm-10pm'
when CONVERT(time, CreatedDate) between '22:00' and '23:00' then '10pm-11pm'
when CONVERT(time, CreatedDate) between '23:00' and '23:59' then '11pm-12am'
else '' end
ORDER BY TimeBracket